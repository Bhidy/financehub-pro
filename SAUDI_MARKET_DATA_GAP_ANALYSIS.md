# Saudi Market Data Gap Analysis & Strategy
**Report Date:** December 29, 2025
**Analysis Subject:** Yahoo Finance Data Availability for Tadawul (Saudi Market)
**Status:** ⚠️ **Significant Data Gap Identified**

---

## 1. Executive Summary
We conducted a live probe on major Saudi stocks (e.g., Al Rajhi Bank `1120.SR`) to inventory **ALL** available data points in the Yahoo Finance ecosystem (`yfinance` / `yahooquery`).

**Findings are Critical:**
- **Available Modules:** 26 unique datasets are fully populated.
- **Currently Collected:** Only **6 modules** (Price, Summary, Profile, KeyStats).
- **The Gap:** We are currently **MISSING ~75%** of the available metadata, including deep financials, ownership structures, and analyst trends.

---

## 2. Detailed Gap Analysis

| Data Category | Module Name | Availability | Status (Current Pipeline) | Recommendation |
| :--- | :--- | :--- | :--- | :--- |
| **Financials** | `incomeStatementHistory` | ✅ **AVAILABLE** | ❌ **MISSING** | **MUST COLLECT** (Revenue, EBIT, Net Income) |
| | `balanceSheetHistory` | ✅ **AVAILABLE** | ❌ **MISSING** | **MUST COLLECT** (Assets, Liabilities, Debt) |
| | `cashflowStatementHistory` | ✅ **AVAILABLE** | ❌ **MISSING** | **MUST COLLECT** (Free Cash Flow, Capex) |
| **Ownership** | `insiderHolders` | ✅ **AVAILABLE** | ❌ **MISSING** | **High Value** (Board members holding shares) |
| | `institutionOwnership` | ✅ **AVAILABLE** | ❌ **MISSING** | **High Value** (Foreign/Local funds) |
| | `majorHoldersBreakdown` | ✅ **AVAILABLE** | ❌ **MISSING** | **High Value** (% Insiders vs Institutions) |
| **Analysis** | `earningsTrend` | ✅ **AVAILABLE** | ❌ **MISSING** | **Medium Value** (EPS Estimates) |
| | `recommendationTrend` | ✅ **AVAILABLE** | ❌ **MISSING** | **Medium Value** (Strong Buy/Hold/Sell) |
| | `industryTrend` | ✅ **AVAILABLE** | ❌ **MISSING** | **Low Value** (Sector performance) |
| **Core** | `price` | ✅ **AVAILABLE** | ✅ **Collected** | Maintained by `local_backfill.py` |
| | `summaryDetail` | ✅ **AVAILABLE** | ✅ **Collected** | Maintained by `local_fundamentals.py` |
| | `summaryProfile` | ✅ **AVAILABLE** | ✅ **Collected** | Maintained by `local_fundamentals.py` |

---

## 3. The "Missing Data" Value Proposition
For an Enterprise Data Feed, the missing components are crucial:
1.  **Deep Financials:** Allows for calculating ratios over time (ROE, ROI, Margin trends) which `pe_ratio` alone cannot provide.
2.  **Ownership:** Reveals who actually controls the company (Government vs Private vs Public).
3.  **Analyst Trends:** Shows market sentiment changes before price action.

---

## 4. Phase 3 Strategy: "Deep Dive"
To close this gap, we need a **Phase 3** implementation immediately after the current backfill stabilizes.

**Plan:** Create `local_deep_dive.py`
- **Target:** Collect `financials`, `balance_sheet`, `cash_flow`, `holders`, `earnings`.
- **Destination:** Store in existing (but empty) Supabase tables:
    - `financial_statements` (JSONB or rows)
    - `major_shareholders`
    - `insider_trading` (or holders table)
    - `analyst_ratings`
- **Schedule:** Run once per week (Financials don't change daily).

---

## 5. Current Status Recap
- **Running:** `local_backfill.py` (Price History - High Volume).
- **Running:** `local_fundamentals.py` (Profile/Snapshot - Medium Volume).
- **Planned:** `local_deep_dive.py` (Deep Financials - Low Volume/Complex).

**Conclusion:** We have confirmed that `yfinance` / `yahooquery` **DO** possess rich data for Saudi markets. We just aren't collecting it yet. The "Phase 3" plan is essential to complete the dataset.

---
**Report Generated by Antigravity**
