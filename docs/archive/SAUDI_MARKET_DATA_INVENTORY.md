# Saudi Market Data Inventory & Phase 3 Strategy
**Status:** ðŸŸ¢ **Active** | **Phase 3 Ready for Launch**

---

## 1. Current Collection Inventory (Active)
These processes are running **NOW**.

### Phase 1: Price Backfill (`local_backfill.py`)
- **Target Table:** `ohlc_data`, `intraday_1h`, `intraday_5m`
- **Data Points:** ~40 Million (Price History)
- **Metrics Collected:**
  - `Open`, `High`, `Low`, `Close`, `Volume`
  - Intervals: Daily (10y), Hourly (2y), 5-Min (60d)

### Phase 2: Fundamental Summary (`local_fundamentals.py`)
- **Target Table:** `market_tickers`, `company_profiles`
- **Data Points:** ~15,000 (Snapshot Data)
- **Metrics Collected:**
  - **Valuation:** `Market Cap`, `PE Ratio`, `PB Ratio`, `Beta`, `Dividend Yield`
  - **Price Stats:** `52w High`, `52w Low`, `Prev Close`, `Open`
  - **Profile:** `Description`, `Website`, `Address`, `Officers (JSON)`

---

## 2. Phase 3: Deep Dive Inventory (Planned Launch)
This process will run in **PARALLEL** (Low speed to ensure stability).

### 2.1 Financial Statements (The "Gold Mine")
- **Target Table:** `financial_statements`
- **Availability:** Annual (4 Years) + Quarterly (4 Quarters)
- **Volume:** ~453 Stocks Ã— 8 Periods Ã— 3 Statements = **~10,872 Reports**
- **Detailed Metrics (per report):**
  - **Income:** `Total Revenue`, `Cost of Revenue`, `Operating Income`, `Net Income`, `EBIT`, `Interest Expense`.
  - **Balance Sheet:** `Total Assets` (Cash, Inventory, Property), `Total Liabilities` (Debt, Payables), `Total Equity`.
  - **Cash Flow:** `Operating Cash Flow`, `Capital Expenditure`, `Free Cash Flow`, `Dividends Paid`.

### 2.2 Ownership & Insiders
- **Target Table:** `major_shareholders` / `insider_trading`
- **Metrics:**
  - **Insider Holders:** Board members owning shares (Name, position, % held).
  - **Major Holders:** Top Institutions/Funds (>5% ownership).

### 2.3 Analyst Estimates (Earnings)
- **Target Table:** `earnings_history` / `analyst_ratings`
- **Metrics:**
  - `EPS Estimate` vs `EPS Actual` (Surprise %).
  - `Earnings Date` (Next announcement).

---

## 3. Parallel Execution Strategy
Can we run Phase 3 **NOW**? **YES.**

**Architecture:**
1.  **Process 1 (Backfill):** Heavy Load (Price). Uses `query1.finance.yahoo.com`.
2.  **Process 2 (Fundamentals):** Light Load (Stats). Uses `query2.finance.yahoo.com` (QuoteSummary).
3.  **Process 3 (Deep Dive):** Light Load (Financials). Uses `query2` but fetches **different modules**.

**Safety Mechanism:**
- Phase 3 will run continuously but **slowly** (Sleep 5s per stock).
- This ensures it acts like a "background crawler" and does not trigger rate limits for the main Price Backfill.

## 4. Est. Datapoints
- **Phase 3 Yield:** ~360,000 High-Value Fundamental records.
- **Completion Time:** ~4 Hours (running concurrently).

---
**Report Generated by Antigravity**
