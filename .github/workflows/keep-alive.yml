name: Keep HF Space Alive

on:
  schedule:
    # Every 15 minutes - prevents HF Space from sleeping (30 min timeout)
    - cron: '*/15 * * * *'
  workflow_dispatch: # Allow manual trigger

jobs:
  ping:
    name: üî• Keep Space Warm
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
      - name: Ping HF Space Health
        run: |
          echo "üî• Pinging HF Space to keep it warm..."
          echo "Time: $(date)"
          
          for i in 1 2 3; do
            echo "Attempt $i/3..."
            response=$(curl -s -o /dev/null -w "%{http_code}" --max-time 180 \
              https://bhidy-financehub-api.hf.space/health)
            echo "HTTP Status: $response"
            
            if [ "$response" = "200" ]; then
              echo "‚úÖ Space is alive and warm!"
              exit 0
            fi
            
            echo "‚è≥ Space may be waking up, waiting 60s..."
            sleep 60
          done
          
          echo "‚ö†Ô∏è Space still waking up after 3 attempts - this is expected for cold starts"
          # Don't fail - the space will wake up eventually
          exit 0
